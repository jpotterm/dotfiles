<?
-- This page uses generic_header.xml.

if not data.name then
data = {
	tracks = 1,
	subscribers = {},
	time = 380,
	name = "test",
	text = "description",
	collaborative = false,
	offline_available = true,
	self = true,
	playlist_subscribed = true,
	can_offline_sync = false,
    can_purchase = true,
	purchase_tracks = 4,
	purchase_price = 2,
	purchase_page = 2,
	image = "",
	can_share = true,
}
end

playlist_title = function()
?>${data.name}<?
end

playlist_stats = function()
?>@{Playlist stats tracks ${data.tracks}}, ${ formatduration(data.time) } <?
end

print_description = function()
	print(data.spider_text)
end

playlist_icon = "SidebarRowIcon|list"
if data.collaborative then
  playlist_icon = "SidebarRowIcon|collab-list"
end
if data.toplist then
  playlist_icon = self and "SidebarRowIcon|toplists" or "SidebarRowIcon|othertoplists"
end

template = {
  image = "transform:multiply:"..data.image.."^skin:RoundedCornersMulMask",
  shadow = "rounded",
  image_alt = "PlaceholderPlaylist|128",
  icon = playlist_icon,
  stats = playlist_stats,
  title = playlist_title,
  title_link = data.link,
  description = print_description,
  offline_available = data.offline_available,
  offline = data.is_offline,
  purchase = {
    page = data.purchase_page,
	price = data.purchase_price,
	tracks = data.purchase_tracks,
	verb = data.purchase_verb,
  },
  title_items = {
    "standard_title",
    "filler",
    "stats"
  },
  toolbar_items = {
    "share",
    "playlist_radio",
  },
  right_items = {
  }
}

include("views/generic_header_subscribers.xml")

if not data.can_share then
  table.remove(template.toolbar_items, 1)
end

if data.subscriber_count ~= 0 then
  table.insert(template.right_items, subscribers)
end

if not data.self then
  template.author = data.owner
  template.author_link = data.owner_link
end

if data.can_subscribe then
  if not data.playlist_subscribed then
    table.insert(template.toolbar_items, "subscribe")
  end
end
if not data.self and data.playlist_subscribed then
  table.insert(template.toolbar_items, "unsubscribe")
end
if data.playlist_subscribed or data.can_offline_sync or data.can_purchase then
  table.insert(template.toolbar_items, "filler")
  if data.can_offline_sync then
    table.insert(template.toolbar_items, "available_offline")
  elseif data.can_purchase then
    table.insert(template.toolbar_items, "purchase")
  end
end

include("views/generic_header.xml")

?>

